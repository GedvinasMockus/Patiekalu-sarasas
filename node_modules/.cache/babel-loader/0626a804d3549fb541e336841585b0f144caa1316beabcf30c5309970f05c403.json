{"ast":null,"code":"import { createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode } from \"vue\";\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_v_toolbar_title = _resolveComponent(\"v-toolbar-title\");\n  const _component_v_btn = _resolveComponent(\"v-btn\");\n  const _component_v_toolbar = _resolveComponent(\"v-toolbar\");\n  const _component_v_divider = _resolveComponent(\"v-divider\");\n  const _component_v_card_title = _resolveComponent(\"v-card-title\");\n  const _component_v_card_actions = _resolveComponent(\"v-card-actions\");\n  const _component_v_card = _resolveComponent(\"v-card\");\n  const _component_v_dialog = _resolveComponent(\"v-dialog\");\n  const _component_LoadingDialog = _resolveComponent(\"LoadingDialog\");\n  const _component_UserForm = _resolveComponent(\"UserForm\");\n  const _component_v_col = _resolveComponent(\"v-col\");\n  const _component_v_row = _resolveComponent(\"v-row\");\n  const _component_v_container = _resolveComponent(\"v-container\");\n  return _openBlock(), _createBlock(_component_v_container, {\n    class: \"fill-height\"\n  }, {\n    default: _withCtx(() => [_createVNode(_component_v_dialog, {\n      modelValue: $setup.deleteDialog.open,\n      \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.deleteDialog.open = $event),\n      \"min-width\": \"335px\",\n      width: \"750px\",\n      persistent: \"\",\n      \"no-click-animation\": \"\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_v_card, null, {\n        default: _withCtx(() => [_createVNode(_component_v_toolbar, {\n          flat: \"\",\n          color: \"blue-grey-lighten-5\",\n          density: \"compact\"\n        }, {\n          append: _withCtx(() => [_createVNode(_component_v_btn, {\n            icon: \"mdi-close\",\n            color: \"grey-darken-3\",\n            onClick: $setup.handleDeleteModalClose\n          }, null, 8 /* PROPS */, [\"onClick\"])]),\n          default: _withCtx(() => [_createVNode(_component_v_toolbar_title, {\n            class: \"text-grey-darken-3 text-h5\"\n          }, {\n            default: _withCtx(() => [_createTextVNode(\"Delete your account\")]),\n            _: 1 /* STABLE */\n          })]),\n          _: 1 /* STABLE */\n        }), _createVNode(_component_v_divider), _createVNode(_component_v_card_title, {\n          class: \"text-h5 text-center text-wrap\"\n        }, {\n          default: _withCtx(() => [_createTextVNode(\" Are you sure you want to delete your account? \")]),\n          _: 1 /* STABLE */\n        }), _createVNode(_component_v_card_actions, {\n          class: \"justify-center\"\n        }, {\n          default: _withCtx(() => [_createVNode(_component_v_btn, {\n            color: \"red-darken-4\",\n            class: \"text-capitalize\",\n            variant: \"elevated\",\n            size: \"large\",\n            onClick: $setup.handleDeleteModalSubmit,\n            loading: $setup.deleteDialog.submitting,\n            disabled: $setup.deleteDialog.submitting\n          }, {\n            default: _withCtx(() => [_createTextVNode(\"Delete\")]),\n            _: 1 /* STABLE */\n          }, 8 /* PROPS */, [\"onClick\", \"loading\", \"disabled\"])]),\n          _: 1 /* STABLE */\n        })]),\n        _: 1 /* STABLE */\n      })]),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"modelValue\"]), _createVNode(_component_LoadingDialog, {\n      modelValue: $setup.loading,\n      \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $setup.loading = $event)\n    }, null, 8 /* PROPS */, [\"modelValue\"]), !$setup.loading ? (_openBlock(), _createBlock(_component_v_row, {\n      key: 0\n    }, {\n      default: _withCtx(() => [_createVNode(_component_v_col, {\n        md: \"8\",\n        \"offset-md\": \"2\",\n        lg: \"6\",\n        \"offset-lg\": \"3\",\n        xl: \"4\",\n        \"offset-xl\": \"4\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_UserForm, {\n          data: $setup.user.editedUser,\n          disabled: $setup.disabled,\n          submitting: $setup.submitting,\n          errors: $setup.inputErrors,\n          onUpdateStart: $setup.handleUpdateStart,\n          onDataUpdate: $setup.handledataUpdate,\n          onUpdateCancel: $setup.handleUpdateCancel,\n          onUpdateConfirm: $setup.handleUpdateConfirm,\n          onDelete: $setup.handleDeleteModalOpen\n        }, null, 8 /* PROPS */, [\"data\", \"disabled\", \"submitting\", \"errors\", \"onUpdateStart\", \"onDataUpdate\", \"onUpdateCancel\", \"onUpdateConfirm\", \"onDelete\"])]),\n        _: 1 /* STABLE */\n      })]),\n      _: 1 /* STABLE */\n    })) : _createCommentVNode(\"v-if\", true)]),\n    _: 1 /* STABLE */\n  });\n}","map":{"version":3,"names":["_createBlock","_component_v_container","class","_createVNode","_component_v_dialog","$setup","deleteDialog","open","$event","width","persistent","_component_v_card","_component_v_toolbar","flat","color","density","append","_withCtx","_component_v_btn","icon","onClick","handleDeleteModalClose","_component_v_toolbar_title","_component_v_divider","_component_v_card_title","_component_v_card_actions","variant","size","handleDeleteModalSubmit","loading","submitting","disabled","_component_LoadingDialog","_component_v_row","key","_component_v_col","md","lg","xl","_component_UserForm","data","user","editedUser","errors","inputErrors","onUpdateStart","handleUpdateStart","onDataUpdate","handledataUpdate","onUpdateCancel","handleUpdateCancel","onUpdateConfirm","handleUpdateConfirm","onDelete","handleDeleteModalOpen"],"sources":["C:\\Users\\Gedvilas\\Desktop 2\\Kirpyklu-sistema-front\\src\\views\\UserInfoView.vue"],"sourcesContent":["<template>\n<v-container class=\"fill-height\">\n\n    <v-dialog v-model=\"deleteDialog.open\" min-width=\"335px\" width=\"750px\" persistent no-click-animation>\n        <v-card>\n            <v-toolbar flat color=\"blue-grey-lighten-5\" density=\"compact\">\n                <v-toolbar-title class=\"text-grey-darken-3 text-h5\">Delete your account</v-toolbar-title>\n                <template v-slot:append>\n                    <v-btn icon=\"mdi-close\" color=\"grey-darken-3\" @click=\"handleDeleteModalClose\"></v-btn>\n                </template>\n            </v-toolbar>\n            <v-divider></v-divider>\n            <v-card-title class=\"text-h5 text-center text-wrap\">\n                Are you sure you want to delete your account?\n            </v-card-title>\n            <v-card-actions class=\"justify-center\">\n                <v-btn color=\"red-darken-4\" class=\"text-capitalize\" variant=\"elevated\" size=\"large\" @click=\"handleDeleteModalSubmit\" :loading=\"deleteDialog.submitting\" :disabled=\"deleteDialog.submitting\">Delete</v-btn>\n            </v-card-actions>\n        </v-card>\n    </v-dialog>\n\n    <LoadingDialog v-model=\"loading\"/>\n    <v-row v-if=\"!loading\">\n        <v-col md=\"8\" offset-md=\"2\" lg=\"6\" offset-lg=\"3\" xl=\"4\" offset-xl=\"4\">\n            <UserForm :data=\"user.editedUser\" :disabled=\"disabled\" :submitting=\"submitting\" :errors=\"inputErrors\" @updateStart=\"handleUpdateStart\" @dataUpdate=\"handledataUpdate\" @updateCancel=\"handleUpdateCancel\" @updateConfirm=\"handleUpdateConfirm\" @delete=\"handleDeleteModalOpen\"/>\n        </v-col>\n    </v-row>\n</v-container>\n</template>\n\n<script>\nimport { reactive, ref } from 'vue'\nimport LoadingDialog from '../components/LoadingDialog.vue'\nimport UserForm from '../components/UserForm.vue'\nimport CloseButton from '../components/CloseButton.vue'\nimport axios from 'axios'\nimport router from '@/router'\nimport { POSITION, useToast } from 'vue-toastification'\nexport default {\n    components: {\n        LoadingDialog,\n        UserForm\n    },\n    props: ['userId', 'token'],\n    setup(props, context) {\n        const toast = useToast()\n\n        const loading = ref(true)\n        const user = reactive({\n            defaultUser: {},\n            editedUser: {},\n        })\n        const disabled = ref(true)\n        const submitting = ref(false)\n        const inputErrors = ref({})\n\n        const deleteDialog = reactive({\n            open: false,\n            submitting: false\n        })\n\n        const handleUpdateStart = () => {\n            disabled.value = false\n        }\n        const handledataUpdate = (value) => {\n            user.editedUser = value\n        }\n        const handleUpdateCancel = () => {\n            disabled.value = true\n            inputErrors.value = {}\n            user.editedUser = Object.assign({}, user.defaultUser)\n        }\n        const handleUpdateConfirm = () => {\n            submitting.value = true\n            const data = {\n                name: user.editedUser.name !== user.defaultUser.name ? user.editedUser.name : undefined,\n                surname: user.editedUser.surname !== user.defaultUser.name ? user.editedUser.surname : undefined,\n                email: user.editedUser.email !== user.defaultUser.email ? user.editedUser.email : undefined,\n                password: user.editedUser.password ? user.editedUser.password : undefined,\n                passwordConfirmation: user.editedUser.passwordConfirmation ? user.editedUser.passwordConfirmation : undefined\n            }\n            axios.patch(`${process.env.VUE_APP_BACKEND_API}/users/${props.userId}`, data)\n                .then((res) => {\n                    inputErrors.value = {}\n                    submitting.value = false\n                    disabled.value = true\n                    user.defaultUser = res.data\n                    user.editedUser = Object.assign({}, res.data)\n                    toast.success('Successfuly updated user information', {\n                        position: POSITION.TOP_CENTER,\n                        timeout: 3000,\n                        closeButton: CloseButton\n                    })\n                }).catch((err) => {\n                    inputErrors.value = {}\n                    if(err.response?.status === 422) {\n                        user.editedUser.password = undefined\n                        user.editedUser.passwordConfirmation = undefined\n                        submitting.value = false\n                        inputErrors.value = err.response.data.errors\n                    }\n                    else if(err.response?.status === 403) {\n                        user.editedUser.password = undefined\n                        user.editedUser.passwordConfirmation = undefined\n                        submitting.value = false\n                        toast.error(err.response.data.message, {\n                            position: POSITION.BOTTOM_CENTER,\n                            timeout: 3000,\n                            closeButton: CloseButton\n                        })\n                    }\n                    else if(err.response?.status === 401) {\n                        axios.post(`${process.env.VUE_APP_BACKEND_API}/users/refresh`)\n                            .then((res) => {\n                                context.emit(('refresh', res.data.accessToken))\n                                axios.patch(`${process.env.VUE_APP_BACKEND_API}/users/${props.userId}`, data)\n                                    .then((res) => {\n                                        submitting.value = false\n                                        disabled.value = true\n                                        user.defaultUser = res.data\n                                        user.editedUser = Object.assign({}, res.data)\n                                        toast.success('Successfuly updated user information', {\n                                            position: POSITION.BOTTOM_CENTER,\n                                            timeout: 3000,\n                                            closeButton: CloseButton\n                                        })\n                                    }).catch((err) => {\n                                        user.editedUser.password = undefined\n                                        user.editedUser.passwordConfirmation = undefined\n                                        submitting.value = false\n                                        if(err.response?.status === 422) {\n                                            inputErrors.value = err.response.data.errors\n                                        }\n                                        else if(err.response?.status === 403) {\n                                            toast.error(err.response.data.message, {\n                                                position: POSITION.BOTTOM_CENTER,\n                                                timeout: 3000,\n                                                closeButton: CloseButton\n                                            })\n                                        }\n                                        else console.log(err)\n                                    })\n                            }).catch(() => {\n                                context.emit('invalidate')\n                                router.push({name: 'login'})\n                            })\n                    }\n                    else console.log(err)\n                })\n        }\n        const handleDeleteModalOpen = () => {\n            deleteDialog.open = true\n        }\n        const handleDeleteModalClose = () => {\n            deleteDialog.open = false\n        }\n        const handleDeleteModalSubmit = () => {\n            deleteDialog.submitting = true\n            axios.delete(`${process.env.VUE_APP_BACKEND_API}/users/${props.userId}`)\n                .then(() => {\n                    deleteDialog.submitting = false\n                    deleteDialog.open = false\n                    context.emit('invalidate')\n                    router.push({name: 'register'})\n                    toast.success('Account was successfully removed', {\n                        position: POSITION.BOTTOM_CENTER,\n                        timeout: 3000,\n                        closeButton: CloseButton\n                    })\n                }).catch((err) => {\n                    if(err.response?.status === 403) {\n                        deleteDialog.submitting = false\n                        toast.error(err.response.data.message, {\n                            position: POSITION.BOTTOM_CENTER,\n                            timeout: 3000,\n                            closeButton: CloseButton\n                        })\n                    }\n                    else if(err.response?.status === 401) {\n                        axios.post(`${process.env.VUE_APP_BACKEND_API}/users/refresh`)\n                            .then((res) => {\n                                context.emit('refresh', res.data.accessToken)\n                                axios.delete(`${process.env.VUE_APP_BACKEND_API}/users/${props.userId}`)\n                                    then(() => {\n                                        deleteDialog.submitting = false\n                                        deleteDialog.open = false\n                                        context.emit('invalidate')\n                                        router.push({name: 'register'})\n                                        toast.success('Account was successfully removed', {\n                                            position: POSITION.BOTTOM_CENTER,\n                                            timeout: 3000,\n                                            closeButton: CloseButton\n                                        })\n                                    }).catch((err) => {\n                                        if(err.response?.status === 403) {\n                                            deleteDialog.submitting = false\n                                            toast.error(err.response.data.message, {\n                                                position: POSITION.BOTTOM_CENTER,\n                                                timeout: 3000,\n                                                closeButton: CloseButton\n                                            })\n                                        }\n                                        else console.log(err)\n                                    })\n                            }).catch(() => {\n                                context.emit('invalidate')\n                                router.push({name: 'login'})\n                            })\n                    }\n                    else console.log(err)\n                })\n        }\n\n        axios.get(`${process.env.VUE_APP_BACKEND_API}/users/${props.userId}`)\n            .then((res) => {\n                loading.value = false\n                user.defaultUser = res.data\n                user.editedUser = Object.assign({},res.data)\n            }).catch((err) => {\n                const to = router.currentRoute.value\n                if(err.response?.status === 404) {\n                    router.replace({\n                        name: 'notFound',\n                        params: {pathMatch: to.path.split('/').slice(1) },\n                        query: to.query,\n                        hash: to.hash\n                    })\n                }\n                else if(err.response?.status === 403) {\n                    toast.error(err.response.data.message, {\n                        position: POSITION.BOTTOM_CENTER,\n                        timeout: 3000,\n                        closeButton: CloseButton\n                    })\n                }\n                else if(err.response?.status === 401) {\n                    axios.post(`${process.env.VUE_APP_BACKEND_API}/users/refresh`)\n                        .then((res) => {\n                            context.emit('refresh', res.data.accessToken)\n                            axios.get(`${process.env.VUE_APP_BACKEND_API}/users/${props.userId}`)\n                                .then((res) => {\n                                    loading.value = false\n                                    user.defaultUser = res.data\n                                    user.editedUser = Object.assign({},res.data)\n                                }).catch((err) => {\n                                    if(err.response?.status === 404) {\n                                        router.replace({\n                                            name: 'notFound',\n                                            params: {pathMatch: to.path.split('/').slice(1) },\n                                            query: to.query,\n                                            hash: to.hash\n                                        })\n                                    }\n                                    else if(err.response?.status === 403) {\n                                        toast.error(err.response.data.message, {\n                                            position: POSITION.BOTTOM_CENTER,\n                                            timeout: 3000,\n                                            closeButton: CloseButton\n                                        })\n                                    }\n                                    else if(!err.response) {\n                                        toast.error('Server is currently offline', {\n                                            position: POSITION.BOTTOM_CENTER,\n                                            timeout: 3000,\n                                            closeButton: CloseButton\n                                        })\n                                    }\n                                    else console.log(err)\n                                })\n                        }).catch(() => {\n                            context.emit('invalidate')\n                            router.replace({ name: 'login' })\n                        })\n                }\n                else if(!err.response) {\n                    toast.error('Server is currently offline', {\n                        position: POSITION.BOTTOM_CENTER,\n                        timeout: 3000,\n                        closeButton: CloseButton\n                    })\n                }\n                else console.log(err)\n            })\n\n        return { \n            loading, \n            user, \n            disabled, \n            submitting, \n            inputErrors,\n            deleteDialog,\n            handleUpdateStart, \n            handledataUpdate, \n            handleUpdateCancel, \n            handleUpdateConfirm,\n            handleDeleteModalOpen,\n            handleDeleteModalClose,\n            handleDeleteModalSubmit\n        }\n    }\n}\n</script>\n\n<style>\n\n</style>"],"mappings":";;;;;;;;;;;;;;;uBACAA,YAAA,CA0BcC,sBAAA;IA1BDC,KAAK,EAAC;EAAa;sBAE5B,MAgBW,CAhBXC,YAAA,CAgBWC,mBAAA;kBAhBQC,MAAA,CAAAC,YAAY,CAACC,IAAI;iEAAjBF,MAAA,CAAAC,YAAY,CAACC,IAAI,GAAAC,MAAA;MAAE,WAAS,EAAC,OAAO;MAACC,KAAK,EAAC,OAAO;MAACC,UAAU,EAAV,EAAU;MAAC,oBAAkB,EAAlB;;wBAC7E,MAcS,CAdTP,YAAA,CAcSQ,iBAAA;0BAbL,MAKY,CALZR,YAAA,CAKYS,oBAAA;UALDC,IAAI,EAAJ,EAAI;UAACC,KAAK,EAAC,qBAAqB;UAACC,OAAO,EAAC;;UAE/BC,MAAM,EAAAC,QAAA,CACnB,MAAsF,CAAtFd,YAAA,CAAsFe,gBAAA;YAA/EC,IAAI,EAAC,WAAW;YAACL,KAAK,EAAC,eAAe;YAAEM,OAAK,EAAEf,MAAA,CAAAgB;;4BAF1D,MAAyF,CAAzFlB,YAAA,CAAyFmB,0BAAA;YAAxEpB,KAAK,EAAC;UAA4B;8BAAC,MAAmB,C,iBAAnB,qBAAmB,E;;;;YAK3EC,YAAA,CAAuBoB,oBAAA,GACvBpB,YAAA,CAEeqB,uBAAA;UAFDtB,KAAK,EAAC;QAA+B;4BAAC,MAEpD,C,iBAFoD,iDAEpD,E;;YACAC,YAAA,CAEiBsB,yBAAA;UAFDvB,KAAK,EAAC;QAAgB;4BAClC,MAA0M,CAA1MC,YAAA,CAA0Me,gBAAA;YAAnMJ,KAAK,EAAC,cAAc;YAACZ,KAAK,EAAC,iBAAiB;YAACwB,OAAO,EAAC,UAAU;YAACC,IAAI,EAAC,OAAO;YAAEP,OAAK,EAAEf,MAAA,CAAAuB,uBAAuB;YAAGC,OAAO,EAAExB,MAAA,CAAAC,YAAY,CAACwB,UAAU;YAAGC,QAAQ,EAAE1B,MAAA,CAAAC,YAAY,CAACwB;;8BAAY,MAAM,C,iBAAN,QAAM,E;;;;;;;;uCAK9M3B,YAAA,CAAkC6B,wBAAA;kBAAV3B,MAAA,CAAAwB,OAAO;iEAAPxB,MAAA,CAAAwB,OAAO,GAAArB,MAAA;8CACjBH,MAAA,CAAAwB,OAAO,I,cAArB7B,YAAA,CAIQiC,gBAAA;MAAAC,GAAA;IAAA;wBAHJ,MAEQ,CAFR/B,YAAA,CAEQgC,gBAAA;QAFDC,EAAE,EAAC,GAAG;QAAC,WAAS,EAAC,GAAG;QAACC,EAAE,EAAC,GAAG;QAAC,WAAS,EAAC,GAAG;QAACC,EAAE,EAAC,GAAG;QAAC,WAAS,EAAC;;0BAC9D,MAA+Q,CAA/QnC,YAAA,CAA+QoC,mBAAA;UAApQC,IAAI,EAAEnC,MAAA,CAAAoC,IAAI,CAACC,UAAU;UAAGX,QAAQ,EAAE1B,MAAA,CAAA0B,QAAQ;UAAGD,UAAU,EAAEzB,MAAA,CAAAyB,UAAU;UAAGa,MAAM,EAAEtC,MAAA,CAAAuC,WAAW;UAAGC,aAAW,EAAExC,MAAA,CAAAyC,iBAAiB;UAAGC,YAAU,EAAE1C,MAAA,CAAA2C,gBAAgB;UAAGC,cAAY,EAAE5C,MAAA,CAAA6C,kBAAkB;UAAGC,eAAa,EAAE9C,MAAA,CAAA+C,mBAAmB;UAAGC,QAAM,EAAEhD,MAAA,CAAAiD"},"metadata":{},"sourceType":"module","externalDependencies":[]}